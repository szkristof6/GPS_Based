import*as API from"../api.js";import*as Cookie from"../cookie.js";const next="join.html",signin="sign.html",index="index.html";document.addEventListener("DOMContentLoaded",(()=>{Cookie.getCookie("Token")&&window.location.replace(next)})),window.addEventListener("load",(()=>{document.querySelector(".container").style.display="none"}));const form=document.querySelector("form"),signinButton=document.querySelector("#signin"),facebookButton=document.querySelector("#facebook");signinButton.addEventListener("click",(()=>window.location.replace(signin))),form.addEventListener("submit",(async e=>{e.preventDefault();const o=new FormData(form),t={email:o.get("email"),password:o.get("password"),token:o.get("g-recaptcha-response")},n=await API.fetchPOST(t,"loginUser");"success"===n.status?(Cookie.setCookie("Token",n.token,Cookie.exp_time),window.location.replace(next)):console.error(n)})),facebookButton.addEventListener("click",(async e=>{const o=await new Promise((e=>FB.login((function(o){e(o)}))));if("connected"===o.status){const e=new FormData(form),t=await API.fetchPOST({...o,token:e.get("g-recaptcha-response")},"facebookLogin");"success"===t.status?(Cookie.setCookie("Token",t.token,Cookie.exp_time),window.location.replace(next)):console.error(t)}}));export async function googleLogin(e){const o=new FormData(form),t=await API.fetchPOST({...e,token:o.get("g-recaptcha-response")},"googleLogin");"success"===t.status?(Cookie.setCookie("Token",t.token,Cookie.exp_time),window.location.replace(next)):console.error(t)}