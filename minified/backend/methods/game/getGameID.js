const bcrypt=require("bcrypt"),games=require("../../db/games"),captcha=require("../captcha");async function getGame(e,s){try{if(!await captcha(e))return void s.send({status:"error",message:"Captcha failed!"});const t=await games.findOne({id:e.body.id});if(null===t)return void s.send({status:"error",message:"This game does not exist!"});if(!t.joinable)return void s.send({status:"error",message:"This game is not active at the moment!"});return await bcrypt.compare(e.body.password,t.password)?void s.send({status:"success",id:t._id}):void s.send({status:"error",message:"The password is incorrect!"})}catch(e){return e.message.startsWith("Argument")&&(e.message="The requested game does not exist!"),void s.send(e)}}module.exports=getGame;